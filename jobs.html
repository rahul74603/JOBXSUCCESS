<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ЁЯФе рдиреМрдХрд░реА рдЕрдкрдбреЗрдЯреНрд╕ - JOBXSUCCESS</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- тЬЕ Config.js рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд░реЗрдВ -->
    <script src="config.js" defer></script>
</head>
<body>

    <h1>ЁЯФе рдиреМрдХрд░реА рдЕрдкрдбреЗрдЯреНрд╕</h1>

    <!-- тЬЕ Loading Message -->
    <p id="loading">тП│ рдЬреЙрдм рдбреЗрдЯрд╛ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...</p>

    <!-- тЬЕ Jobs Table -->
    <table id="jobs-table" border="1">
        <thead>
            <tr>
                <th>ЁЯФ╣ рдиреМрдХрд░реА рдХрд╛ рдирд╛рдо</th>
                <th>ЁЯПв рдХрдВрдкрдиреА</th>
                <th>ЁЯУЕ рдЕрдВрддрд┐рдо рддрд┐рдерд┐</th>
                <th>тЮбя╕П рдЖрд╡реЗрджрди</th>
            </tr>
        </thead>
        <tbody>
            <!-- тЬЕ рдЬреЙрдм рдбреЗрдЯрд╛ рдпрд╣рд╛рдВ рд▓реЛрдб рд╣реЛрдЧрд╛ -->
        </tbody>
    </table>

    <!-- тЬЕ JavaScript Script рд▓реЛрдб рдХрд░реЗрдВ -->
    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            console.log("ЁЯЪА Config.js рд▓реЛрдб рд╣реБрдЖ:", window.API_URL); // тЬЕ Debugging

            let API_URL = window.API_URL; // тЬЕ Google Sheets API URL

            const tableBody = document.querySelector("#jobs-table tbody");
            const loadingElement = document.getElementById("loading");

            async function fetchJobs() {
                try {
                    loadingElement.style.display = "block"; // тЬЕ Show Loading
                    tableBody.innerHTML = ""; // тЬЕ Clear Old Data

                    console.log("ЁЯМН Fetching Jobs from API...");
                    let response = await fetch(`${API_URL}?t=${new Date().getTime()}`);
                    
                    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

                    let jobs = await response.json();

                    if (!Array.isArray(jobs)) throw new Error("Invalid Data Format from API");

                    // тЬЕ Insert Data into Table
                    jobs.forEach(job => {
                        let row = document.createElement("tr");

                        row.innerHTML = `
                            <td>${job["JOBS TITLE"]}</td>
                            <td>${job["ORGANIZATION"] || "N/A"}</td>
                            <td>${job["LAST DATE"] || "N/A"}</td>
                            <td><a href="${job["APPLY LINK"]}" target="_blank">Apply</a></td>
                        `;

                        tableBody.appendChild(row);
                    });

                    loadingElement.style.display = "none"; // тЬЕ Hide Loading
                } catch (error) {
                    console.error("тЭМ Error fetching jobs:", error);
                    loadingElement.textContent = "тЭМ рдЬреЙрдм рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛!";
                }
            }

            fetchJobs();
        });
    </script>

</body>
</html>
